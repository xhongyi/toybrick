#include <stdio.h>#include <stdlib.h>#include "2BWT-Interface.h"#define SEED_FILE "seed.inp"#define OUTPUT "seed.out"int main() {  int i,j,k,c;  int index;  //Variables for backward and forward search  unsigned int l,r,rev_l,rev_r;      //Variables for search all sa ranges functions  unsigned int result_l[ALPHABET_SIZE];  unsigned int result_r[ALPHABET_SIZE];  unsigned int result_rev_l[ALPHABET_SIZE];  unsigned int result_rev_r[ALPHABET_SIZE];      // Load up the index with the below statement  printf("Loading index ... ");   fflush(stdout);  //    Idx2BWT * idx2BWT = BWTLoad2BWT("mini_genome.fasta.index",".sa"); // test input file  //Idx2BWT * idx2BWT = BWTLoad2BWT("mini_genome.fasta.index",".sa");  Idx2BWT * idx2BWT = BWTLoad2BWT("human_g1k_v37.fasta.1.index",".sa");  printf("DONE\n\n");       // Open the seed file  FILE *fp;  fp = fopen(SEED_FILE,"r");  if( fp == NULL ){    perror("Error while opening the file.\n");    exit(EXIT_FAILURE);  }  /*  // Open the output file  FILE *output;  output = fopen(OUTPUT,"w");  if( output == NULL ){    perror("Error while opening the file.\n");    exit(EXIT_FAILURE);    }*/  while(1){        //Variables for result    unsigned int offset;    int sequenceId;    unsigned int saCount;        //Variables for pattern    char pattern[1024];        // break out if at the end of the file or a blank line    if(fgets(pattern, sizeof(pattern), fp) == NULL){      break;    }        strtok(pattern, "\n");    int patternLength = strlen(pattern);    // Convert the pattern into 2BWT recognised coding scheme    BWTConvertPattern(idx2BWT,pattern,patternLength,pattern);        // The following performs a bi-directional search of the pattern    // Starting from the middle of the pattern, first move right, then move left.    // ===================================================================================    // |    j = patternLength / 2;    BWTSARangeInitial(idx2BWT,pattern[j],&l,&r);    BWTSARangeInitial(idx2BWT,pattern[j],&rev_l,&rev_r);    for (i=j+1;i<patternLength;i++) {      BWTSARangeForward_Bidirection(idx2BWT,pattern[i],&l,&r,&rev_l,&rev_r);    }    for (i=j-1;i>=0;i--) {      BWTSARangeBackward_Bidirection(idx2BWT,pattern[i],&l,&r,&rev_l,&rev_r);    }    printf("SA Range being = %u %u %u %u (%u)\n\n",l,r,rev_l,rev_r,r-l+1);    // |    // ===================================================================================            // output the results    // ===================================================================================    // |    // |    j=r-l+1;    for (i=0;i<j;i++) {      BWTRetrievePositionFromSAIndex(idx2BWT,l+i,&sequenceId,&offset);      //printf("Occurrence found in sequence #%d with offset %u\n",sequenceId,offset);      //      fprintf(output, "Occurrence found in sequence #%d with offset %u\n",sequenceId,offset);    }    // |    // |    // ===================================================================================  }      // Free up the 2BWT index  printf("\nFree index ... ");   fflush(stdout);  BWTFree2BWT(idx2BWT);  printf("DONE\n");       return 0;}